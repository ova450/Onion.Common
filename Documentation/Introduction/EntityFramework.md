# Datashell Development Entity Framework CodeFirst Starter (EFCFS)

**Версия:** 9.6.37

### 1. Введение

Эта документация описывает комплекс пакетов разработчика Datashell Development Entity Framework CodeFirst Starter (EFCFS).  EFCFS предназначен для упрощения разработки приложений, использующих Entity Framework CodeFirst для маппинга базы данных. Структура комплекса основана на Onion-архитектуре, однако, он применим и в других архитектурах.

### 2. Entity Framework (EF)

*Этот раздел предназначен для разработчиков, не знакомых с Entity Framework.  Если вы уже имеете базовые знания об EF, переходите к разделу 3. Назначение, цели и задачи комплекса ECFCS*

Entity Framework (EF) - это объектно-реляционный маппер (ORM) для .NET. 
Он упрощает работу с базами данных, позволяя разработчикам взаимодей-
ствовать с данными с помощью объектов .NET. EF предоставляет различные 
подходы к настройке маппинга, которые можно разделить на две основные 
концепции: Database First и Code First.

##### 2.1. Основные концепции Entity Framework

**Database First:**  В данном случае сначала создается база данных со всеми 
таблицами, связями, индексами и атрибутами.  ORM генерирует классы .NET, 
соответствующие таблицам базы данных. Database First удобен при наличии 
графических инструментов для проектирования ER-диаграмм.  Однако,  вне-
сение изменений в структуру базы данных может быть затруднительным.  
Без визуальных инструментов создание базы данных с помощью SQL-
скриптов становится аналогичным Code First, но с использованием других 
средств.

**Code First:**  Этот подход позволяет разработчикам определять модели 
данных с помощью кода C# или VB.NET *до создания базы данных*.  EF со-
здает базу данных на основе этих моделей. Code First упрощает рефакторинг 
и миграцию базы данных, поскольку все изменения вносятся в код .NET.

##### 2.2. Entity Framework CodeFirst

Code First предлагает несколько способов определения моделей данных и 
связей между сущностями:

* **Convention over Configuration (Соглашение по конфигурации):**  EF авто-
  матически определяет связи и свойства на основе соглашений об именова-
  нии. Это самый простой подход.
* **Fluent API:**  Более гибкий и мощный способ настройки маппинга с по-
  мощью специального API.
* **Атрибуты данных:**  Атрибуты, применяемые к классам и свойствам мо-
  дели,  позволяют задавать конфигурацию маппинга.
* **Навигационные свойства:**  Свойства в классах модели, представляющие 
  связи между сущностями.

Методы можно комбинировать, начиная с простых решений и переходя к 
более сложным по мере необходимости.

##### 2.3. Контекст базы данных

В Code First модели данных реализуются через контекст базы данных. Для этого создается класс, который наследуется от DbContext (входящего в состав пакета Microsoft.EntityFrameworkCore). Контекст настраивается путем подключения провайдера для конкретной платформы базы данных (например, Microsoft.EntityFrameworkCore.SqlServer) и указания параметров подключения. Затем в контекст добавляются свойства типа DbSet<T>, представляющие коллекции сущностей. После этого можно создавать экземпляры контекста и использовать их для взаимодействия с базой данных. Создание экземпляра контекста также генерирует создание собственно базы данных.

Ниже приведен пример класса контекста:

```
using Microsoft.EntityFrameworkCore;

namespace Examples;

public class ApplicationDbContext: DbContext
{
    protected override void OnConfiguring(DbContextOptionsBuilder 
optionsBuilder) => 
optionsBuilder.UseSqlServer(@"Server=(localdb)\MSSQLLocalDB; Initial 
Catalog=dbCobra; Integrated Security=True");

    public DbSet<Foo> Foos { get; set; }
    public DbSet<Bar> Bars { get; set; }
}
```

### 3. Назначение, цель и задачи комплекса EFCFS

Как уже было сказано выше, EFCFS предназначен для упрощения разработки приложений, использующих Entity Framework CodeFirst для маппинга базы данных. 

 В общем случае, целью комплекса является очистка кода приложения от 
рутинных процедур за счет их переноса в абстрактные объекты или реализованные экземпляры классов, размещенные в пакеты комплекса.

##### 3.1 Задачи

Обобщенную 

- Предоставление интерфейсов и абстрактных классов для реализации доменной модели (Domain Model) приложения (entity-classes);

- Предоставление интерфейсов и абстрактных классов для реализации доменных сервисов (Domain Service) приложения в соотвествии с паттерном Repository;

- 
